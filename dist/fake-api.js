!function(global){const keyPrefix="fakeCollection_";function trimBearerPrefix(str){return str.replace(/^Bearer\s+/i,"")}function generateJWT(userId){const payload={userId:userId,exp:Date.now()+108e5};return`${btoa(JSON.stringify({alg:"HS256",typ:"JWT"}))}.${btoa(JSON.stringify(payload))}.${btoa("secret")}`}function verifyJWT(jwt){let token=trimBearerPrefix(jwt);const[encodedHeader,encodedPayload,encodedSignature]=token.split(".");if(!encodedHeader||!encodedPayload||!encodedSignature)return!1;JSON.parse(atob(encodedHeader));const payload=JSON.parse(atob(encodedPayload));return"secret"===atob(encodedSignature)&&!(Date.now()>payload.exp)}function getLocalStorageDataByCreator(key,isUserProvided=!0){const hasKeyPrefix=key.startsWith(keyPrefix),hasUserSuffix=key.endsWith("__user")||key.endsWith("__default");if(hasKeyPrefix&&hasUserSuffix)return JSON.parse(localStorage.getItem(key));const userKey=key+"__user",defaultKey=key+"__default";if(isUserProvided){return JSON.parse(localStorage.getItem(keyPrefix+userKey))}return JSON.parse(localStorage.getItem(keyPrefix+defaultKey))}function getLocalStorageData(key){const hasKeyPrefix=key.startsWith(keyPrefix),hasUserSuffix=key.endsWith("__user")||key.endsWith("__default");if(hasKeyPrefix&&hasUserSuffix)return JSON.parse(localStorage.getItem(key));const userKey=key+"__user",defaultKey=key+"__default",userData=JSON.parse(localStorage.getItem(keyPrefix+userKey)),defaultData=JSON.parse(localStorage.getItem(keyPrefix+defaultKey));return userData||defaultData}function setLocalStorageData(key,data,isUserProvided=!0){if(key.startsWith(keyPrefix)&&(key.endsWith("__user")||key.endsWith("__default")))localStorage.setItem(key,JSON.stringify(data));else{const suffix=isUserProvided?"__user":"__default";localStorage.setItem(keyPrefix+key+suffix,JSON.stringify(data))}}function initializeFakeApiData(initialData,isUserProvided=!0){for(const key in initialData)getLocalStorageDataByCreator(key,isUserProvided)||setLocalStorageData(key,initialData[key],isUserProvided);getLocalStorageDataByCreator("users",isUserProvided)||setLocalStorageData("users",[{id:1,username:"admin",password:"admin",firstName:"Vivek",lastName:"Agarwal"}])}function setProtectedFakeApiData(data,isUserProvided=!0){const currentData=JSON.parse(localStorage.getItem("protectedData")||"[]");(isUserProvided||0===currentData.length)&&localStorage.setItem("protectedData",JSON.stringify(data))}function getAllHandler(key){const data=getLocalStorageData(key);return new Response(JSON.stringify(data),{status:200})}function applyCustomFilters(data,customFilters){const filteredData=[];for(const item of data){let matchesAllFilters=!0;for(const[param,value]of customFilters){const operatorMatch=param.match(/(.+)(_gte|_lte|_ne|_like)$/);if(operatorMatch){const[,originalParam,operator]=operatorMatch;switch(operator){case"_gte":item.hasOwnProperty(originalParam)&&item[originalParam]<value&&(matchesAllFilters=!1);break;case"_lte":item.hasOwnProperty(originalParam)&&item[originalParam]>value&&(matchesAllFilters=!1);break;case"_ne":item.hasOwnProperty(originalParam)&&item[originalParam]==value&&(matchesAllFilters=!1);break;case"_like":item.hasOwnProperty(originalParam)&&!item[originalParam].includes(value)&&(matchesAllFilters=!1)}}else item.hasOwnProperty(param)&&item[param]!=value&&(matchesAllFilters=!1);if(!matchesAllFilters)break}matchesAllFilters&&filteredData.push(item)}return filteredData}function getFilteredDataHandler(data,queryParams,id){if(queryParams.q&&(data=function(data,query){return data.filter((item=>Object.values(item).some((value=>String(value).toLowerCase().includes(query.toLowerCase())))))}(data,queryParams.q)),queryParams._sort){const sortKeys=queryParams._sort.split(","),sortOrder=queryParams._order?queryParams._order.split(","):sortKeys.map((()=>"asc"));data=function(data,sortKeys,sortOrder){return data.sort(((a,b)=>{for(let i=0;i<sortKeys.length;i++){const key=sortKeys[i],order="desc"===sortOrder[i]?-1:1;if(a[key]<b[key])return-1*order;if(a[key]>b[key])return order}return 0}))}(data,sortKeys,sortOrder)}const filterKeys=["q","_sort","_order","_limit","_page"];if(data=applyCustomFilters(data,Object.entries(queryParams).filter((([param])=>!filterKeys.includes(param)))),void 0!==queryParams._limit||void 0!==queryParams._page){data=function(data,limit,page){const start=(page-1)*limit,end=start+limit,paginatedData=data.slice(start,end);return paginatedData}(data,parseInt(queryParams._limit,10)||10,parseInt(queryParams._page,10)||1)}return data}function getKeyFromUrl(url){const keyPart=url.replace("https://mockapi.com","").split("?")[0].split("/")[1],localStorageKeys=Object.keys(function(){const schema={};for(let i=0;i<localStorage.length;i++){const key=localStorage.key(i);key.startsWith(keyPrefix)&&(schema[key]=!0)}return schema}());let userKey,defaultKey;defaultKey=localStorageKeys.find((item=>item.endsWith("__default")&&item.includes(keyPart.trim()))),userKey=localStorageKeys.find((item=>item.endsWith("__user")&&item.includes(keyPart.trim())));return userKey||defaultKey}async function handleCRUDOperations(url,method,body,options){const key=getKeyFromUrl(url),id=function(url){return url.replace("https://mockapi.com","").split("?")[0].split("/")[2]}(url),queryParams=function(url){const queryParamsMatch=url.match(/\?(.*)/);return queryParamsMatch?Object.fromEntries(queryParamsMatch[1].split("&").map((p=>p.split("=")))):{}}(url),isRouteUserSpecific=options&&options.isRouteUserSpecific,userIdFromToken=options&&options.userId;let data,totalCount;if("GET"!==method){if("POST"===method)return await function(key,body,options){const data=getLocalStorageData(key),newItem=JSON.parse(body),isRouteUserSpecific=options&&options.isRouteUserSpecific,userIdFromToken=options&&options.userId;if(userIdFromToken&&isRouteUserSpecific&&!newItem.userId&&(newItem.userId=userIdFromToken),!newItem.id){const maxId=data.length>0?Math.max(...data.map((item=>item.id))):0;newItem.id=maxId+1}return data.push(newItem),setLocalStorageData(key,data),new Response(JSON.stringify(newItem),{status:201})}(key,body,{isRouteUserSpecific:isRouteUserSpecific,userId:userIdFromToken});if("PUT"===method&&id)return await function(key,id,body,options){const data=getLocalStorageData(key),index=data.findIndex((item=>item.id==id)),isRouteUserSpecific=options&&options.isRouteUserSpecific,userIdFromToken=options&&options.userId;if(-1===index)throw{status:404,message:"Not Found"};const updatedItem=JSON.parse(body);return updatedItem.id=id,userIdFromToken&&isRouteUserSpecific&&!newItem.userId&&(newItem.userId=userIdFromToken),data[index]=updatedItem,setLocalStorageData(key,data),new Response(JSON.stringify(updatedItem),{status:200})}(key,id,body);if("DELETE"===method&&id)return await function(key,id){const data=getLocalStorageData(key),index=data.findIndex((item=>item.id==id));if(-1===index)throw{status:404,message:"Not Found"};return data.splice(index,1),setLocalStorageData(key,data),new Response(JSON.stringify({deleted:id}),{status:200})}(key,id);if("PATCH"===method&&id)return await function(key,id,body,options){const data=getLocalStorageData(key),index=data.findIndex((item=>item.id==id)),isRouteUserSpecific=options&&options.isRouteUserSpecific,userIdFromToken=options&&options.userId;if(-1===index)throw{status:404,message:"Not Found"};const newData=JSON.parse(body);return userIdFromToken&&isRouteUserSpecific&&!newItem.userId&&(newItem.userId=userIdFromToken),data[index]={...data[index],...newData},setLocalStorageData(key,data),new Response(JSON.stringify(data[index]),{status:200})}(key,id,body);throw new Error(`Invalid request for url: ${url}`)}data=await getAllHandler(key),totalCount=data.length||0,isRouteUserSpecific&&(data=applyCustomFilters(data,[["userId",userIdFromToken]])),id&&(data=applyCustomFilters(data,[["id",id]])),Object.keys(queryParams).length>0&&(data=getFilteredDataHandler(data,queryParams));const responseHeaders={"Content-Type":"application/json","X-Total-Count":totalCount};return new Response(JSON.stringify(data),{status:200,headers:responseHeaders})}function getAllHandler(key){return getLocalStorageData(key)}async function mockFetch(url,options={}){const{method:method="GET",headers:headers,body:body}=options;return new Promise(((resolve,reject)=>{setTimeout((async()=>{try{const protectedData=JSON.parse(localStorage.getItem("protectedData")||"[]");let userId,protectedRoute=!1,isRouteUserSpecific=!1;for(let i=0;i<protectedData.length;i++){let keyFromUrl=getKeyFromUrl(url);if(keyFromUrl){const itemRouteKey=protectedData[i].route.toLowerCase().trim();let trimmedKeyFromUrl=keyFromUrl.replace("fakeCollection_","");if(trimmedKeyFromUrl=trimmedKeyFromUrl.replace("__default",""),trimmedKeyFromUrl.trim().toLowerCase()===itemRouteKey.trim().toLowerCase()){protectedRoute=protectedData[i],isRouteUserSpecific=protectedData[i].isUserSpecific;break}}}if(protectedRoute&&protectedRoute.methods.includes(method)&&(!headers||!headers.Authorization||!verifyJWT(headers.Authorization)))throw new Error("Unauthorized");if(protectedRoute&&protectedRoute.methods.includes(method)&&headers.Authorization&&verifyJWT(headers.Authorization)){let headerAuthToken=headers.Authorization;headerAuthToken&&(userId=function(jwt){let token=trimBearerPrefix(jwt);try{if(!verifyJWT(token))return null;const payloadBase64=token.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),payloadJson=atob(payloadBase64);return JSON.parse(payloadJson).userId}catch(error){return null}}(headerAuthToken))}if(url.endsWith("/register")&&"POST"===method){const response=function(body){const userData=JSON.parse(body),users=getLocalStorageData("users");return userData.id=users.length+1,users.push(userData),setLocalStorageData("users",users),new Response(JSON.stringify({message:"User registered successfully"}),{status:201})}(body);return void resolve(response)}if(url.endsWith("/login")&&"POST"===method){const response=function(body){const{username:username,password:password}=JSON.parse(body),user=getLocalStorageData("users").find((u=>u.username===username&&u.password===password));if(user)return new Response(JSON.stringify({token:generateJWT(user.id)}),{status:200});throw new Error("Invalid credentials")}(body);return void resolve(response)}const response=handleCRUDOperations(url,method,body,{isRouteUserSpecific:isRouteUserSpecific,userId:userId});if(!response)throw new Error(`Unknown route: ${url}`);resolve(response)}catch(error){reject(error)}}),Math.floor(500*Math.random())+100)})).catch((error=>({ok:!1,status:"Unauthorized"===error.message?401:400,message:error.message,json:()=>Promise.resolve({error:error.message})})))}initializeFakeApiData({orders:[{id:1,userId:1,items:[{productId:1,quantity:2},{productId:2,quantity:1}],discount:0},{id:2,userId:2,items:[{productId:3,quantity:3},{productId:4,quantity:1}],discount:100}],products:[{id:1,brand:"Zebronics",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/n/y/nyfboat000113_1_cc965b26.jpg?rnd=20200526195200",price:100,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Laptop"},{id:2,brand:"Zebronics",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/n/y/nyfblta000011_1.jpg?rnd=20200526195200",price:120,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Mobile"},{id:3,brand:"Zebronics",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/b/c/bc60a_1_c82d81cb.jpg?rnd=20200526195200",price:130,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Head_Phones"},{id:4,brand:"Zebronics",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/6/1/619660798426_1_727221ba.jpg?rnd=20200526195200",price:100,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Speakers"},{id:5,brand:"Zebronics",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/c/_/c_8907605107849_1_655fcbdf.jpg?rnd=20200526195200",price:200,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Smart_TV"},{id:6,brand:"Apple",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/c/o/cor-nyfcrca000039_1_369033fe.jpg?rnd=20200526195200",price:235,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Laptop"},{id:7,brand:"Apple",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/a/m/ambrane_8904258106557_1_aff3c266.jpg?rnd=20200526195200",price:250,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Mobile"},{id:8,brand:"Apple",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/n/y/nyfblta000009_1.jpg?rnd=20200526195200",price:100,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Head_Phones"},{id:9,brand:"Apple",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/z/b/zb_8906108615899_1_44867a4c.jpg?rnd=20200526195200",price:325,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Speakers"},{id:10,brand:"Apple",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/u/d/ud_bk_1_2f275806.jpg?rnd=20200526195200",price:350,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Smart_TV"},{id:11,brand:"HP",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/g/r/grey_1_398b5873.jpg?rnd=20200526195200",price:375,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Laptop"},{id:12,brand:"HP",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/b/o/boult-audio-ba-nk-freepods-black_1_17c2dc71.jpg?rnd=20200526195200",price:100,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Mobile"},{id:13,brand:"HP",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/d/i/dive_green_1.jpg?rnd=20200526195200",price:500,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Head_Phones"},{id:14,brand:"HP",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/p/e/pebble-8906086572115_1_34a9b9fd.jpg?rnd=20200526195200",price:1e3,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Speakers"},{id:15,brand:"HP",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/p/p/pportronics-por-1195_1_e9dc8e9f.jpg?rnd=20200526195200",price:750,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Smart_TV"},{id:16,brand:"Dell",img:"https://adn-static1.nykaa.com/nykdesignstudio-images/tr:w-550,/pub/media/catalog/product/m/u/musebud_grey.jpg?rnd=20200526195200",price:1500,details:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Iusto, sequi.",category:"Laptop"}],users:[{id:1,username:"admin",password:"admin",firstName:"Vivek",lastName:"Agarwal",avatar:"https://reqres.in/img/faces/9-image.jpg",email:"admin@mail.com"},{id:2,username:"john",password:"john",firstName:"John",lastName:"Doe",avatar:"https://reqres.in/img/faces/8-image.jpg",email:"john@mail.com"},{id:3,username:"jane",password:"jane",firstName:"Jane",lastName:"Doe",avatar:"https://reqres.in/img/faces/7-image.jpg",email:"jane@mail.com"}]},!1),setProtectedFakeApiData([{route:"orders",methods:["GET","POST","PUT","PATCH","DELETE"],isUserSpecific:!0}],!1),global.initializeFakeApiData=initializeFakeApiData,global.setProtectedFakeApiData=setProtectedFakeApiData;const originalFetch=global.fetch;global.fetch=async function(url,options){return url.includes("mockapi.com")?mockFetch(url,options):originalFetch(url,options)}}("undefined"!=typeof window?window:module.exports);